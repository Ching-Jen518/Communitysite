
@{
    var data = ViewBag.everyposts;
}

<div id="HomeContainer" class="container">

    <div class="row">

        @foreach (var item in data)
        {

            <div class="col-sm-8">
                <div class="border mb-3">
                    <div class="card border-0  mb-3" style="width:100%;">
                        <div class="bg-transparent border-top-0 border-left-0 border-right-0 form-inline d-flex mt-3 ml-3">

                            <div class="p2">
                                <img id="personalphoto1" class="img-thumbnail" src="~/Selfphoto/@item.GetType().GetProperty("Photo").GetValue(item)" />
                            </div>
                            <div class="p2">
                                <span class="h5"><strong>@item.GetType().GetProperty("MemberName").GetValue(item)</strong></span><br />
                                <span class="h6"> @item.GetType().GetProperty("Account").GetValue(item)</span>
                            </div>

                            <div class="p2 ml-auto nav-item dropdown ">
                                <a class="nav-link dropdown-toggle caret-off" href="#" id="navbarDropdownPersonal" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                    <img width="20" src="~/image/點點點.jpg" />
                                </a>
                                <div class="dropdown-menu" aria-labelledby="navbarDropdownPersonal">
                                    @{ if (Session["account"].ToString() == item.GetType().GetProperty("MemberID").GetValue(item))
                                        {
                                            <a class="dropdown-item" href="@Url.Action("Edit", "Posts", new { id = item.GetType().GetProperty("PostID").GetValue(item) })">修改貼文</a>
                                            <a class="dropdown-item" href="@Url.Action("Delete", "Posts", new { id = item.GetType().GetProperty("PostID").GetValue(item) })">刪除</a>
                                        }
                                        else
                                        {
                                            <a class="dropdown-item" href="#">檢舉貼文</a>
                                        }

                                    }
                                </div>

                            </div>
                        </div>
                        <hr />

                        <div class="card-body text-dark border-bottom">

                            <div id="carouselpersonal2" class="carousel slide" data-ride="carousel">
                                <ol class="carousel-indicators">
                                    <li data-target="#carouselpersonal2" data-slide-to="0" class="active"></li>
                                    <li data-target="#carouselpersonal2" data-slide-to="1"></li>
                                    <li data-target="#carouselpersonal2" data-slide-to="2"></li>
                                </ol>
                                <div class="carousel-inner">
                                    @{
                                        var count = 0;
                                    }
                                    @foreach (var pp in @item.GetType().GetProperty("pps").GetValue(item))
                                    {
                                        if (count == 0)
                                        {
                                            <div class="carousel-item active">
                                                <img src="~/Photo/@pp.GetType().GetProperty("Photo").GetValue(pp)" class="d-block w-100" alt="...">
                                            </div>

                                            count++;
                                        }
                                        else
                                        {
                                            <div class="carousel-item">
                                                <img src="~/Photo/@pp.GetType().GetProperty("Photo").GetValue(pp)" class="d-block w-100" alt="...">
                                            </div>
                                        }


                                    }

                                </div>
                                <a class="carousel-control-prev" href="#carouselpersonal2" role="button" data-slide="prev">
                                    <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                                    <span class="sr-only">Previous</span>
                                </a>
                                <a class="carousel-control-next" href="#carouselpersonal2" role="button" data-slide="next">
                                    <span class="carousel-control-next-icon" aria-hidden="true"></span>
                                    <span class="sr-only">Next</span>
                                </a>
                            </div>
                        </div>



                    </div>
                </div>
            </div>


            <div class="col-sm-4">
                <div class="card-header">
                    <span class="h5"><strong>@item.GetType().GetProperty("MemberName").GetValue(item)</strong></span>&nbsp;&nbsp;
                    <span class="h6"> @item.GetType().GetProperty("PostContent").GetValue(item)</span>
                </div>
                <div class="card-body">
                    @foreach (var pc in item.GetType().GetProperty("pcs").GetValue(item))
                    {
                        <span class="h5"><strong>@pc.GetType().GetProperty("MemberName").GetValue(pc)</strong></span>
                        @:&nbsp;&nbsp;
                        <span class="h6">@pc.GetType().GetProperty("Comment1").GetValue(pc)</span><br />
                    }

                </div>
                <div>

                    <div class="card-footer bg-transparent border-secondary border-top-0">
                        <div class="form-inline">
                            
                                <div class="mx-2">
                                    <img id="like"  name="Like" value="true" class="width" src="~/image/heart鍵(黑白框).jpg" />
                                    <img id="like1"  name="Like" value="false" class="width" src="~/image/heart鍵(紅愛心).jpg" />
                                </div>
                            
                                <div class="mx-2">
                                    <img id="message" class="width" src="~/image/messagr鍵(黑白).jpg" />
                                </div>
                            </div>
                        <div>
                            <span> @ViewBag.like 個讚</span>
                        </div>
                        <hr />
                        @using (Html.BeginForm("EveryPosts", "Home", FormMethod.Post))
                        {
                    <div class=" border-0 form-group row no-gutters">
                        <input class="form-control border-0 col-sm-10 " name="Comm" id="postcomment" type="text" placeholder="留言……" />

                        <input type="submit" class="form-control border-0 col-sm-2" id="PushCommentButton" value="發怖" />
                        <input type="hidden" name="PostID" id="PushCommentButton" value="@item.GetType().GetProperty("PostID").GetValue(item)" />
                    </div>
                        }
                        </div>
                </div>
            </div>

        }
    </div>
</div>
    <script src="~/Scripts/jquery-3.5.1.min.js"></script>
    <script src="~/Scripts/bootstrap.bundle.min.js"></script>
    <script>
    //--------停止內文照片每五秒一動一次----------
    $('.carousel').carousel({
        interval: false
    })

        //抓取點讚
        $('#like').click(function () {
            $('#like').css("display", "none");
            $('#like1').css("display", "block");
            var like = $('#like').val();
            var dataJSON = {}
            dataJSON["Like"]="true"

        });

         $('#like1').click(function () {
            $('#like1').css("display", "none");
            $('#like').css("display", "block");

        });

    </script>